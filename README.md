# E-Commerce Feedback Classification

Этот проект предназначен для классификации обратной связи от клиентов в сфере электронной коммерции. Для решения задачи мультилейбл классификации текстов были обучены 2 QLoRA-адаптера для *Gemma2-9b-it*.

## Содержание

- [Требуемые ресурсы](#требуемые-ресурсы)
- [Установка](#установка)
- [Запуск](#запуск)
- [Использование](#использование)
- [Структура проекта](#структура-проекта)

## Требуемые ресурсы

Для обучения и инференса моделей потребуется 2x NVIDIA Tesla T4, 4 vCPU Intel Xeon (бесплатные ресурсы Kaggle).

## Установка

1. **Клонируйте репозиторий**:

   ```bash
   git clone https://github.com/l1ghtsource/ecom-tech-workshop.git
   cd ecom-tech-workshop
   ```

2. **Создайте виртуальное окружение (рекомендуется)**:

   ```bash
   python -m venv venv
   source venv/bin/activate  # На Windows используйте `venv\Scripts\activate`
   ```

3. **Установите зависимости**:

   ```bash
   pip install -r requirements.txt
   ```

## Запуск

1. **Запустите обучение моделей или скачайте предобученные модели**:

   По мере необходимости можно предварительно отредактировать файлы конфигурации в папке `configs/` и обучающую выборку в папке `data/`.
   
   ```bash
   make train
   make train_new
   ```
   
   В случае, если хотите воспользоваться уже обученными моделями, скачайте их веса:
   ```bash
   make download
   ```

2. **Запустите инференс**:

   Для выполнения инференса используйте следующие команды:
   
   ```bash
   make inference
   make inference_new
   ```

3. **Конвертируйте результаты**:

   После выполнения инференса, выполните конвертацию результатов:
   
   ```bash
   make convert
   ```

4. **Запустите Streamlit приложение**:

   Чтобы запустить интерфейс Streamlit, используйте следующую команду:
   
   ```bash
   streamlit run app.py
   ```

## Использование

В интерфейсе Streamlit вы можете:

- Ввести оценку, теги и текст отзыва клиента.
- Выбрать режим инференса (заглушка или полноценный инференс).
- Получить график вероятностей для каждой категории, основанный на введенных данных.

## Структура проекта

```
ecom-tech-workshop/
│
├── app.py                  # Основной файл приложения Streamlit
├── configs/                # Конфигурационные файлы для обучения и инференса
│   ├── train_cfg_1.yaml
│   ├── train_cfg_2.yaml
│   ├── inference_cfg_1.yaml
│   └── inference_cfg_2.yaml
│
├── notebooks/              # Папка с Jupyter-ноутбуками
│   ├── convert.ipynb
│   ├── inference_1.ipynb
│   ├── inference_2.ipynb
│   ├── train_1.ipynb
│   └── train_2.ipynb
│
├── data/                   # Папка с данными
│   ├── example.csv
│   ├── train.csv
│   └── test.csv
│
├── src/                    # Исходные скрипты
│   ├── train.py            # Код обучения модели
│   ├── inference.py        # Код инференса модели
│   └── convert.py          # Код конвертации результатов в формат сабмита
│
├── train.sh                # Скрипт для запуска обучения модели
├── inference.sh            # Скрипт для выполнения инференса
├── convert.sh              # Скрипт для конвертации результатов
├── requirements.txt        # Файл с зависимостями
└── README.md               # Документация проекта
```
